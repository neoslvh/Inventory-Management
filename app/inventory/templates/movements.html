{% extends 'base.html' %}
{% block title %}Stock Movements{% endblock %}
{% block content %}
<h4>Stock Movements</h4>
<form method="POST" class="card card-body mb-3">
    <div class="row g-3">
        <div class="col-md-2">
            <label class="form-label">Type</label>
            <select name="type" class="form-select">
                <option>IN</option><option>OUT</option><option>TRANSFER</option>
            </select>
        </div>
        <div class="col-md-4">
            <label class="form-label">Product</label>
                <select name="product_id" class="form-select">
{% for p in products %}<option value="{{p.id}}">{{p.name}} ({{p.sku}})</option>{% endfor %}
                </select>
        </div>
        <div class="col-md-2">
            <label class="form-label">Qty</label>
            <input name="quantity" type="number" min="1" class="form-control" required />
        </div>
        <div class="col-md-2"><label class="form-label">Batch</label><input name="batch_no" class="form-control" /></div>
        <div class="col-md-2"><label class="form-label">Unit Cost</label><input name="unit_cost" type="number" step="0.01" class="form-control" /></>
        <div class="col-md-3"><label class="form-label">From</label>
            <select name="from_warehouse_id" class="form-select"><option value="">—</option>{% for w in warehouses %}<option value="{{w.id}}">{{w.name}}</option>{% endfor %}</select>
        </div>
        <div class="col-md-3"><label class="form-label">To</label>
            <select name="to_warehouse_id" class="form-select"><option value="">—</option>{% for w in warehouses %}<option value="{{w.id}}">{{w.name}}</option>{% endfor %}</select>
        </div>
    </div>
    <div class="mt-3"><button class="btn btn-primary">Record</button></div>
</form>


<table class="table table-sm table-striped">
    <thead><tr><th>Time</th><th>Type</th><th>Product</th><th>Qty</th><th>From</th><th>To</th><th>Batch</th></tr></thead>
    <tbody>
{% for m in moves %}
        <tr>
            <td>{{ m.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
            <td>{{ m.type }}</td>
            <td>{{ m.product.name }}</td>
            <td>{{ m.quantity }}</td>
            <td>{{ m.from_warehouse.name if m.from_warehouse else '-' }}</td>
            <td>{{ m.to_warehouse.name if m.to_warehouse else '-' }}</td>
            <td>{{ m.batch_no or '-' }}</td>
        </tr>
{% endfor %}
    </tbody>
</table>
{% endblock %}